import io
import runtime

func run //files
	pass; 0
	fail; 0

	for file; //files
		'\n`file`\n' io.print
		'import \'`file`\' testing' eval
		exports; clear 'testing' runtime.exports
		for export; //exports
			if /export 'test-' starts-with
				try 'testing.`export`' eval
				if not
					err; clear recv
					'  FAIL: `export`: `err`\n' io.print
					fail; inc
				else
					'  pass: `export`\n' io.print
					pass; inc
		'testing' undef

	'\n`pass` tests passed, `fail` failed' io.print
	/fail 0 eq

